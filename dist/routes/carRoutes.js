import { Router } from "express";
import isAdmin from "../middlewares/isAdmin.js";
import upload from "../services/upload/multer.js";
import initializeCar from "../controllers/car/newCar/initialize.js";
import setEngine from "../controllers/car/newCar/engine.js";
import setCarFeatures from "../controllers/car/newCar/carFeatures.js";
import uploadCarImages from "../controllers/car/newCar/uploadCarImages.js";
import getCarsList from "../controllers/car/browse/getCarsList.js";
import getCar from "../controllers/car/browse/getCar.js";
import deleteCar from "../controllers/car/delete/deleteCar.js";
import updateCar from "../controllers/car/update/updateCar.js";
import updateEngine from "../controllers/car/update/updateEngine.js";
import { errorHandler } from "../middlewares/errorHandler.js";
import getIncompletedInfoCars from "../controllers/car/browse/getIncompletedInfoCars.js";
const carsRouter = Router();
carsRouter.post('/init', errorHandler(isAdmin), errorHandler(initializeCar));
carsRouter.post('/engine', errorHandler(isAdmin), errorHandler(setEngine));
carsRouter.put('/feature/:id', errorHandler(isAdmin), errorHandler(setCarFeatures));
carsRouter.put('/images/:id', upload.fields([{ name: "images", maxCount: 4 }, { name: "main", maxCount: 1 }]), errorHandler(isAdmin), errorHandler(uploadCarImages));
carsRouter.get('/all', errorHandler(getCarsList));
carsRouter.get('/incompleted', errorHandler(isAdmin), errorHandler(getIncompletedInfoCars));
carsRouter.get('/:id', errorHandler(getCar));
carsRouter.put('/:id', errorHandler(isAdmin), errorHandler(updateCar));
carsRouter.put('/engine/:id', errorHandler(isAdmin), errorHandler(updateEngine));
carsRouter.delete('/:id', errorHandler(isAdmin), errorHandler(deleteCar));
export default carsRouter;
